[gd_scene load_steps=4 format=2]

[sub_resource type="GDScript" id=3]
script/source = "extends Control


# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"
var data : Dictionary = {
	\"game_dir\":\"./game/\",
	\"game_list\" : [
		{
			\"nama\":\"free person shooter\",
			\"offline\" : false
		}
	]
}
var game_dir : String = \"./\"
# Called when the node enters the scene tree for the first time.
func _ready():
	make_dir(\"game\")
	if OS.has_feature(\"editor\") : 
		print(\"test\")
		var f : File= File.new()
		f.open(\"./data\",File.WRITE) 
		f.store_var(data)
		f.close()
		f.open(\"./bin/data\",File.WRITE) 
		f.store_var(data)
		f.close()
		game_dir = data.get(\"game_dir\")
		print(game_list())
	
	
	
	
	
func game_list(game:String = \"./game/\") -> Array :
	var opsi : Node = preload(\"res://codeartstudio/game_opsi.tscn\").instance()
	var files : Array
	var x  : Directory = Directory.new()
	x.open(game)
	x.list_dir_begin()
	var file = x.get_next()
	while file != \"\" :
		files.append(file)
		if !file.begins_with(\".\") :
			var v : Node = opsi.duplicate()
			v.path = $TabContainer
			v.game_forder = game + file
			$TabContainer/beranda/pilihan_game.add_child(v)
		file = x.get_next()
	x.list_dir_end()
	return files
	
func make_dir (nama:String) :
	var f : Directory =Directory.new()
	f.open(game_dir)
	f.make_dir_recursive(nama)




"

[sub_resource type="GDScript" id=2]
script/source = "extends Button


# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"


# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.


func _on_google_pressed():
	$\"../../../TabContainer\".visible = true
	$\"../..\".visible = false
"

[sub_resource type="GDScript" id=4]
script/source = "extends HTTPRequest


# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"


# Called when the node enters the scene tree for the first time.

	
var update : bool = true

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	if OS.has_feature(\"editor\") :
		if update :
			if request(\"https://rifqideveloper.github.io/code-art-Launcher/data\") == OK:
				update = false
				print(\"berhasil\")
			
	


func _on_HTTPRequest_request_completed(result, response_code, headers, body):
	var f : File= File.new()
	f.open(\"./data\",File.READ) 
	var v = f.get_var()
	$\"..\".game_dir = v.get(\"game_dir\")
	print($\"..\".game_dir)
	f.close()
	$\"..\".game_list(v.get(\"game_dir\"))
"

[node name="main" type="Control"]
anchor_right = 1.0
anchor_bottom = 1.0
script = SubResource( 3 )

[node name="TabContainer" type="TabContainer" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
tab_align = 0

[node name="beranda" type="Tabs" parent="TabContainer"]
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 4.0
margin_top = 32.0
margin_right = -4.0
margin_bottom = -4.0
tab_align = 0

[node name="pilihan_game" type="GridContainer" parent="TabContainer/beranda"]
anchor_right = 1.0
anchor_bottom = 1.0

[node name="pengaturan" type="Tabs" parent="TabContainer"]
visible = false
margin_right = 40.0
margin_bottom = 24.0

[node name="CenterContainer" type="CenterContainer" parent="."]
visible = false
anchor_right = 1.0
anchor_bottom = 1.0

[node name="VBoxContainer" type="VBoxContainer" parent="CenterContainer"]
margin_left = 471.0
margin_top = 281.0
margin_right = 552.0
margin_bottom = 319.0

[node name="Label" type="Label" parent="CenterContainer/VBoxContainer"]
margin_right = 81.0
margin_bottom = 14.0
text = "login dengan"

[node name="google" type="Button" parent="CenterContainer/VBoxContainer"]
margin_top = 18.0
margin_right = 81.0
margin_bottom = 38.0
text = "google"
script = SubResource( 2 )

[node name="HTTPRequest" type="HTTPRequest" parent="."]
download_file = "res://data"
use_threads = true
script = SubResource( 4 )

[connection signal="pressed" from="CenterContainer/VBoxContainer/google" to="CenterContainer/VBoxContainer/google" method="_on_google_pressed"]
[connection signal="request_completed" from="HTTPRequest" to="HTTPRequest" method="_on_HTTPRequest_request_completed"]
